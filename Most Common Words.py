import speech_recognition as sr
import collections
import re
import os
import winsound
import time

# Here we can ignore words commonly used in english if we only care about more specific words
def jobs_done():
    os.system('cmd /c "MSG %USERNAME% Task Completed! && EXIT"')
    winsound.PlaySound("notification", winsound.SND_ALIAS)
    print("End of processes")
    print("Total time:", (time.time() - entireRuntimeStart))
    exit()

r = sr.Recognizer()
englishCharacterMinimum: int = 4
testing: bool = True
englishMostCommon: set = {r"""gonna""", r"""going""", r"""really""", r""""goes""", r""""saying""", r"""didn""", r"""don""", r"""s""", r"""t""", r"""m""", r"""ve""", r"""re""", r"""the""", r"""of""", r"""to""", r"""and""", r"""a""", r"""in""", r"""is""", r"""it""", r"""you""", r"""that""", r"""he""", r"""was""", r"""for""", r"""on""", r"""are""", r"""with""", r"""as""", r"""i""", r"""his""", r"""they""", r"""be""", r"""at""", r"""one""", r"""have""", r"""this""", r"""from""", r"""or""", r"""had""", r"""by""", r"""not""", r"""word""", r"""but""", r"""what""", r"""some""", r"""we""", r"""can""", r"""out""", r"""other""", r"""were""", r"""all""", r"""there""", r"""when""", r"""up""", r"""use""", r"""your""", r"""how""", r"""said""", r"""an""", r"""each""", r"""she""", r"""which""", r"""do""", r"""their""", r"""time""", r"""if""", r"""will""", r"""way""", r"""about""", r"""many""", r"""then""", r"""them""", r"""write""", r"""would""", r"""like""", r"""so""", r"""these""", r"""her""", r"""long""", r"""make""", r"""thing""", r"""see""", r"""him""", r"""two""", r"""has""", r"""look""", r"""more""", r"""day""", r"""could""", r"""go""", r"""come""", r"""did""", r"""number""", r"""sound""", r"""no""", r"""most""", r"""people""", r"""my""", r"""over""", r"""know""", r"""water""", r"""than""", r"""call""", r"""first""", r"""who""", r"""may""", r"""down""", r"""side""", r"""been""", r"""now""", r"""find""", r"""any""", r"""new""", r"""work""", r"""part""", r"""take""", r"""get""", r"""place""", r"""made""", r"""live""", r"""where""", r"""after""", r"""back""", r"""little""", r"""only""", r"""round""", r"""man""", r"""year""", r"""came""", r"""show""", r"""every""", r"""good""", r"""me""", r"""give""", r"""our""", r"""under""", r"""name""", r"""very""", r"""through""", r"""just""", r"""form""", r"""sentence""", r"""great""", r"""think""", r"""say""", r"""help""", r"""low""", r"""line""", r"""differ""", r"""turn""", r"""cause""", r"""much""", r"""mean""", r"""before""", r"""move""", r"""right""", r"""boy""", r"""old""", r"""too""", r"""same""", r"""tell""", r"""does""", r"""set""", r"""three""", r"""want""", r"""air""", r"""well""", r"""also""", r"""play""", r"""small""", r"""end""", r"""put""", r"""home""", r"""read""", r"""hand""", r"""port""", r"""large""", r"""spell""", r"""add""", r"""even""", r"""land""", r"""here""", r"""must""", r"""big""", r"""high""", r"""such""", r"""follow""", r"""act""", r"""why""", r"""ask""", r"""men""", r"""change""", r"""went""", r"""light""", r"""kind""", r"""off""", r"""need""", r"""house""", r"""picture""", r"""try""", r"""us""", r"""again""", r"""animal""", r"""point""", r"""mother""", r"""world""", r"""near""", r"""build""", r"""self""", r"""earth""", r"""father""", r"""head""", r"""stand""", r"""own""", r"""page""", r"""should""", r"""country""", r"""found""", r"""answer""", r"""school""", r"""grow""", r"""study""", r"""still""", r"""learn""", r"""plant""", r"""cover""", r"""food""", r"""sun""", r"""four""", r"""between""", r"""state""", r"""keep""", r"""eye""", r"""never""", r"""last""", r"""let""", r"""thought""", r"""city""", r"""tree""", r"""cross""", r"""farm""", r"""hard""", r"""start""", r"""might""", r"""story""", r"""saw""", r"""far""", r"""sea""", r"""draw""", r"""left""", r"""late""", r"""run""", r"""don't""", r"""while""", r"""press""", r"""close""", r"""night""", r"""real""", r"""life""", r"""few""", r"""north""", r"""open""", r"""seem""", r"""together""", r"""next""", r"""white""", r"""children""", r"""begin""", r"""got""", r"""walk""", r"""example""", r"""ease""", r"""paper""", r"""group""", r"""always""", r"""music""", r"""those""", r"""both""", r"""mark""", r"""often""", r"""letter""", r"""until""", r"""mile""", r"""river""", r"""car""", r"""feet""", r"""care""", r"""second""", r"""book""", r"""carry""", r"""took""", r"""science""", r"""eat""", r"""room""", r"""friend""", r"""began""", r"""idea""", r"""fish""", r"""mountain""", r"""stop""", r"""once""", r"""base""", r"""hear""", r"""horse""", r"""cut""", r"""sure""", r"""watch""", r"""color""", r"""face""", r"""wood""", r"""main""", r"""enough""", r"""plain""", r"""girl""", r"""usual""", r"""young""", r"""ready""", r"""above""", r"""ever""", r"""red""", r"""list""", r"""though""", r"""feel""", r"""talk""", r"""bird""", r"""soon""", r"""body""", r"""dog""", r"""family""", r"""direct""", r"""pose""", r"""leave""", r"""song""", r"""measure""", r"""door""", r"""product""", r"""black""", r"""short""", r"""numeral""", r"""class""", r"""wind""", r"""question""", r"""happen""", r"""complete""", r"""ship""", r"""area""", r"""half""", r"""rock""", r"""order""", r"""fire""", r"""south""", r"""problem""", r"""piece""", r"""told""", r"""knew""", r"""pass""", r"""since""", r"""top""", r"""whole""", r"""king""", r"""space""", r"""heard""", r"""best""", r"""hour""", r"""better""", r"""true""", r"""during""", r"""hundred""", r"""five""", r"""remember""", r"""step""", r"""early""", r"""hold""", r"""west""", r"""ground""", r"""interest""", r"""reach""", r"""fast""", r"""verb""", r"""sing""", r"""listen""", r"""six""", r"""table""", r"""travel""", r"""less""", r"""morning""", r"""ten""", r"""simple""", r"""several""", r"""vowel""", r"""toward""", r"""war""", r"""lay""", r"""against""", r"""pattern""", r"""slow""", r"""center""", r"""love""", r"""person""", r"""money""", r"""serve""", r"""appear""", r"""road""", r"""map""", r"""rain""", r"""rule""", r"""govern""", r"""pull""", r"""cold""", r"""notice""", r"""voice""", r"""unit""", r"""power""", r"""town""", r"""fine""", r"""certain""", r"""fly""", r"""fall""", r"""lead""", r"""cry""", r"""dark""", r"""machine""", r"""note""", r"""wait""", r"""plan""", r"""figure""", r"""star""", r"""box""", r"""noun""", r"""field""", r"""rest""", r"""correct""", r"""able""", r"""pound""", r"""done""", r"""beauty""", r"""drive""", r"""stood""", r"""contain""", r"""front""", r"""teach""", r"""week""", r"""final""", r"""gave""", r"""green""", r"""oh""", r"""quick""", r"""develop""", r"""ocean""", r"""warm""", r"""free""", r"""minute""", r"""strong""", r"""special""", r"""mind""", r"""behind""", r"""clear""", r"""tail""", r"""produce""", r"""fact""", r"""street""", r"""inch""", r"""multiply""", r"""nothing""", r"""course""", r"""stay""", r"""wheel""", r"""full""", r"""force""", r"""blue""", r"""object""", r"""decide""", r"""surface""", r"""deep""", r"""moon""", r"""island""", r"""foot""", r"""system""", r"""busy""", r"""test""", r"""record""", r"""boat""", r"""common""", r"""gold""", r"""possible""", r"""plane""", r"""stead""", r"""dry""", r"""wonder""", r"""laugh""", r"""thousand""", r"""ago""", r"""ran""", r"""check""", r"""game""", r"""shape""", r"""equate""", r"""hot""", r"""miss""", r"""brought""", r"""heat""", r"""snow""", r"""tire""", r"""bring""", r"""yes""", r"""distant""", r"""fill""", r"""east""", r"""paint""", r"""language""", r"""among""", r"""grand""", r"""ball""", r"""yet""", r"""wave""", r"""drop""", r"""heart""", r"""am""", r"""present""", r"""heavy""", r"""dance""", r"""engine""", r"""position""", r"""arm""", r"""wide""", r"""sail""", r"""material""", r"""size""", r"""vary""", r"""settle""", r"""speak""", r"""weight""", r"""general""", r"""ice""", r"""matter""", r"""circle""", r"""pair""", r"""include""", r"""divide""", r"""syllable""", r"""felt""", r"""perhaps""", r"""pick""", r"""sudden""", r"""count""", r"""square""", r"""reason""", r"""length""", r"""represent""", r"""art""", r"""subject""", r"""region""", r"""energy""", r"""hunt""", r"""probable""", r"""bed""", r"""brother""", r"""egg""", r"""ride""", r"""cell""", r"""believe""", r"""fraction""", r"""forest""", r"""sit""", r"""race""", r"""window""", r"""store""", r"""summer""", r"""train""", r"""sleep""", r"""prove""", r"""lone""", r"""leg""", r"""exercise""", r"""wall""", r"""catch""", r"""mount""", r"""wish""", r"""sky""", r"""board""", r"""joy""", r"""winter""", r"""sat""", r"""written""", r"""wild""", r"""instrument""", r"""kept""", r"""glass""", r"""grass""", r"""cow""", r"""job""", r"""edge""", r"""sign""", r"""visit""", r"""past""", r"""soft""", r"""fun""", r"""bright""", r"""gas""", r"""weather""", r"""month""", r"""million""", r"""bear""", r"""finish""", r"""happy""", r"""hope""", r"""flower""", r"""clothe""", r"""strange""", r"""gone""", r"""jump""", r"""baby""", r"""eight""", r"""village""", r"""meet""", r"""root""", r"""buy""", r"""raise""", r"""solve""", r"""metal""", r"""whether""", r"""push""", r"""seven""", r"""paragraph""", r"""third""", r"""shall""", r"""held""", r"""hair""", r"""describe""", r"""cook""", r"""floor""", r"""either""", r"""result""", r"""burn""", r"""hill""", r"""safe""", r"""cat""", r"""century""", r"""consider""", r"""type""", r"""law""", r"""bit""", r"""coast""", r"""copy""", r"""phrase""", r"""silent""", r"""tall""", r"""sand""", r"""soil""", r"""roll""", r"""temperature""", r"""finger""", r"""industry""", r"""value""", r"""fight""", r"""lie""", r"""beat""", r"""excite""", r"""natural""", r"""view""", r"""sense""", r"""ear""", r"""else""", r"""quite""", r"""broke""", r"""case""", r"""middle""", r"""kill""", r"""son""", r"""lake""", r"""moment""", r"""scale""", r"""loud""", r"""spring""", r"""observe""", r"""child""", r"""straight""", r"""consonant""", r"""nation""", r"""dictionary""", r"""milk""", r"""speed""", r"""method""", r"""organ""", r"""pay""", r"""age""", r"""section""", r"""dress""", r"""cloud""", r"""surprise""", r"""quiet""", r"""stone""", r"""tiny""", r"""climb""", r"""cool""", r"""design""", r"""poor""", r"""lot""", r"""experiment""", r"""bottom""", r"""key""", r"""iron""", r"""single""", r"""stick""", r"""flat""", r"""twenty""", r"""skin""", r"""smile""", r"""crease""", r"""hole""", r"""trade""", r"""melody""", r"""trip""", r"""office""", r"""receive""", r"""row""", r"""mouth""", r"""exact""", r"""symbol""", r"""die""", r"""least""", r"""trouble""", r"""shout""", r"""except""", r"""wrote""", r"""seed""", r"""tone""", r"""join""", r"""suggest""", r"""clean""", r"""break""", r"""lady""", r"""yard""", r"""rise""", r"""bad""", r"""blow""", r"""oil""", r"""blood""", r"""touch""", r"""grew""", r"""cent""", r"""mix""", r"""team""", r"""wire""", r"""cost""", r"""lost""", r"""brown""", r"""wear""", r"""garden""", r"""equal""", r"""sent""", r"""choose""", r"""fell""", r"""fit""", r"""flow""", r"""fair""", r"""bank""", r"""collect""", r"""save""", r"""control""", r"""decimal""", r"""gentle""", r"""woman""", r"""captain""", r"""practice""", r"""separate""", r"""difficult""", r"""doctor""", r"""please""", r"""protect""", r"""noon""", r"""whose""", r"""locate""", r"""ring""", r"""character""", r"""insect""", r"""caught""", r"""period""", r"""indicate""", r"""radio""", r"""spoke""", r"""atom""", r"""human""", r"""history""", r"""effect""", r"""electric""", r"""expect""", r"""crop""", r"""modern""", r"""element""", r"""hit""", r"""student""", r"""corner""", r"""party""", r"""supply""", r"""bone""", r"""rail""", r"""imagine""", r"""provide""", r"""agree""", r"""thus""", r"""capital""", r"""won't""", r"""chair""", r"""danger""", r"""fruit""", r"""rich""", r"""thick""", r"""soldier""", r"""process""", r"""operate""", r"""guess""", r"""necessary""", r"""sharp""", r"""wing""", r"""create""", r"""neighbor""", r"""wash""", r"""bat""", r"""rather""", r"""crowd""", r"""corn""", r"""compare""", r"""poem""", r"""string""", r"""bell""", r"""depend""", r"""meat""", r"""rub""", r"""tube""", r"""famous""", r"""dollar""", r"""stream""", r"""fear""", r"""sight""", r"""thin""", r"""triangle""", r"""planet""", r"""hurry""", r"""chief""", r"""colony""", r"""clock""", r"""mine""", r"""tie""", r"""enter""", r"""major""", r"""fresh""", r"""search""", r"""send""", r"""yellow""", r"""gun""", r"""allow""", r"""print""", r"""dead""", r"""spot""", r"""desert""", r"""suit""", r"""current""", r"""lift""", r"""rose""", r"""continue""", r"""block""", r"""chart""", r"""hat""", r"""sell""", r"""success""", r"""company""", r"""subtract""", r"""event""", r"""particular""", r"""deal""", r"""swim""", r"""term""", r"""opposite""", r"""wife""", r"""shoe""", r"""shoulder""", r"""spread""", r"""arrange""", r"""camp""", r"""invent""", r"""cotton""", r"""born""", r"""determine""", r"""quart""", r"""nine""", r"""truck""", r"""noise""", r"""level""", r"""chance""", r"""gather""", r"""shop""", r"""stretch""", r"""throw""", r"""shine""", r"""property""", r"""column""", r"""molecule""", r"""select""", r"""wrong""", r"""gray""", r"""repeat""", r"""require""", r"""broad""", r"""prepare""", r"""salt""", r"""nose""", r"""plural""", r"""anger""", r"""claim""", r"""continent""", r"""oxygen""", r"""sugar""", r"""death""", r"""pretty""", r"""skill""", r"""women""", r"""season""", r"""solution""", r"""magnet""", r"""silver""", r"""thank""", r"""branch""", r"""match""", r"""suffix""", r"""especially""", r"""fig""", r"""afraid""", r"""huge""", r"""sister""", r"""steel""", r"""discuss""", r"""forward""", r"""similar""", r"""guide""", r"""experience""", r"""score""", r"""apple""", r"""bought""", r"""led""", r"""pitch""", r"""coat""", r"""mass""", r"""card""", r"""band""", r"""rope""", r"""slip""", r"""win""", r"""dream""", r"""evening""", r"""condition""", r"""feed""", r"""tool""", r"""total""", r"""basic""", r"""smell""", r"""valley""", r"""nor""", r"""double""", r"""seat""", r"""arrive""", r"""master""", r"""track""", r"""parent""", r"""shore""", r"""division""", r"""sheet""", r"""substance""", r"""favor""", r"""connect""", r"""post""", r"""spend""", r"""chord""", r"""fat""", r"""glad""", r"""original""", r"""share""", r"""station""", r"""dad""", r"""bread""", r"""charge""", r"""proper""", r"""bar""", r"""offer""", r"""segment""", r"""slave""", r"""duck""", r"""instant""", r"""market""", r"""degree""", r"""populate""", r"""chick""", r"""dear""", r"""enemy""", r"""reply""", r"""drink""", r"""occur""", r"""support""", r"""speech""", r"""nature""", r"""range""", r"""steam""", r"""motion""", r"""path""", r"""liquid""", r"""log""", r"""meant""", r"""quotient""", r"""teeth""", r"""shell""", r"""neck"""}
entireRuntimeStart = time.time()

PATH = 'audio_file_only.wav'

if not testing:
    with sr.AudioFile(PATH) as source:
        audio = r.record(source)
        audioTranscribed = r.recognize_sphinx(audio)
else:
    audioTranscribed: str = r"""we sweep from glad that i discovered this to myself and didn't like chance i've really needed never taking the side of the fifth amounts please please please thank you i do this you know and that you're gonna go you have a go you're gonna go unit at the local gave both you and it any enemy that shoots the laser beams must pay just a little bit of focus goes along length or guards have nothing to firm that the want of water that on what they laugh role we're going this document chain reaction you gonna get me in trouble some olin jones state chilled state shields are then the opportunity to use dark guards on c. b. adderley of time going to need a good breakfast and in the gymnasium is like super quiet and in your stomach like forty five minutes in his third gold like ruled the world that we're in the u. ago my god i'm probably like to people in whose stomach offensive as when you've got a shout out immediately they are saying almost on a tuesday cuba down three bombs thank you thank you for legumes and cos like to someone for example help me he did not follow up in mine was my therefore why is it that it was on or it wasn't always a mccraw wobble you know what happened not icon was small so i've thought it was a treaty but now i'm lookin' back in my hand on my feet no drink it looks like that but this goes away that icon was presented that i thought it was a treaty is the u. scores traveling on a swing this monstrous to amuse us turnabout is fair play list of evolves in english although the besides poland boss you fly after it was thought that simply is that the reason is that true and improve with those are the beast was the all that is the single day you sing out like a year in the storms is lying that'll change your life now i will say he might change your life for that trial you have you relied on my life who then within the norm sue you know when they were younger to be our trajectory they would let me put this way if you could give them was that one of cultural sliding doors they might be like i would try another week of assumed it was a bill to stand up to that level of scrutiny but kate is probably better than if you can inject an image at ease that that that's true that would that would be a remarkable movie for some other reasons as opposed to it a couple look at the youth vote will vote no on they are distinguishable but it takes a discerning now wants a villain of one so forth and one is rubbish in one's american and yet it they do all the activists each other's topple the hangar in star wars of the one of the memphis of that's all i'm saying okay the result is that wrong good you know what i have a live it's all about that meant he got a myth that was where you sit down and finally the no second to use this item where we will buy what is your shop not owns and then i get over drove up the game but we did what at if thorough grizzard iago thirty out it i know thankfully shingle the shameful the shank has some more of the wesat at some more of the always address them are up get to go on for months even get down to suppress it the fifth corps has been trained for an no offense that's not a sapphire to feel that thing off one of the words of his arrival in place if there is just what the half that is of all your place man or no overflowing will move bold move off and go to that look at who and who own health depth of put all but the old man that twelve point all the seven point oh it's fantastic i do like the people paying it all you wave as my inward john look at that app where his goal by an unknown is the milkman thwart one of mac's it it really pop don't go fish address the eighth felt rejected as too things go bad something good slinky this one's for you brother fifth let's go up if no all of them no look have the full with ice dragged that injects pharaoh khufu were guards are shot selection on that one little thing that should have all the new three d. wanted to to to guide the triple killer of moulton when it happens to the family leave what doth going south to date on all the big guy with isabel would be classified and that up with great effect to the mines hot as the thing in my world gulped as low as ended better than i expected to be helpful what's the blue that knowledge that but my god all i got away alive and well i got and get somebody not finn has dropped the gun and a conical in shape columbine to bring that it happen it will 'cause it's a lot back back back out to the business and that is creepy not yet in resenting arid then yeah a narrow don't broken up and then as i do not have an n. i look at it proved or not it up and he won't with the tough order it i conclude about whether it's about to give us the gardens and our number out the outlet is among them a tough whoa whoa hey i'm gonna have a very often ins in an even eight you nobody wants this green boobs skateboard i guess all take it had back to wiener all four and and and then hope this brother this game shows you the first trial the mole last one and then all of pictures is that as a good deal for your order yeah moping mo but we've been him in to a passage good lad or not i'm i'm sorry uncle everyday life out there all unknown south africa identified and i had that space then there was no time left him what's there was no talk of what owed his letting letting lead a rabbit i'm to have a cup huh bob or if it does it mean wake up that and a dime i read apologize for the first thing that i didn't that that might be brought to us that the two is or isn't this the run around makes you speed round the prompt writing and not the kind with the end here late i don't i'm an idiot out you'd bowden well"""

print("Entire Audio:", audioTranscribed)
words = re.findall(r'\w+', audioTranscribed)
wordsFinal: list = []
for word in words:
    if len(word) >= englishCharacterMinimum and word.lower() not in englishMostCommon:
        wordsFinal.append(word.lower())
audioCommonWords = collections.Counter(wordsFinal).most_common(100)
print("Most Common Words:", audioCommonWords)

jobs_done()
